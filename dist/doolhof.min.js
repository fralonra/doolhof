!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(t=t||self).Labyrinth=n()}(this,function(){"use strict";const t=0,n=1;function e(t,n,e){const{x:o,y:s}=n,r=[];return t[o]&&t[o][s-e]&&r.push(t[o][s-e]),t[o-e]&&t[o-e][s]&&r.push(t[o-e][s]),t[o]&&t[o][s+e]&&r.push(t[o][s+e]),t[o+e]&&t[o+e][s]&&r.push(t[o+e][s]),r}function o(t){return Math.floor(Math.random()*t)}return class{constructor(t){this.options={...{generate:!0,row:10,col:10,start:[1,0]},...t},this.options.end||(this.options.end=[2*this.options.col-1,2*this.options.row]),this.fmtMaze=null,this.options.generate&&this.generate()}generate(){const s=function(o){const{row:s,col:r}=o,i=[];for(let e=0;e<2*r+1;++e){const o=[];for(let r=0;r<2*s+1;++r){const s={x:e,y:r};e%2==1&&r%2==1?(s.type=n,s.visited=!1):s.type=t,o.push(s)}i.push(o)}return i.forEach(t=>t.forEach(t=>{t.path=function(t,n){return e(t,n,2)}(i,t),t.wall=function(t,n){return e(t,n,1)}(i,t)})),i}(this.options);!function(t,e){const{row:s,col:r,start:i,end:c}=e;let h;const l=[],u=[];function f(e,o){return e.visited||(e.visited=!0,l.push(e)),o?(h=t[(e.x+o.x)/2][(e.y+o.y)/2]).type=n:h=null,o}(function t(n,e=1){return n.reduce((n,o)=>n.concat(e>1&&Array.isArray(o)?t(o,e-1):o),[])})(t).filter(t=>t.type===n).forEach((t,n)=>{u[n]=t});const p=s*r;let a=t[1][1];for(;l.length<p;){const t=a.path;let e;const s=t.filter(t=>!t.visited);if(s.length)e=s[o(s.length)];else{const s=a.wall.filter(t=>t.type===n);s.length?(1!==s.length||h&&1===s.lengh&&h.x!==s[0].x&&h.y!==s[0].y)&&u.splice(u.findIndex(t=>t.x===a.x&&t.y===a.y),1):e=t[o(t.length)]}a=f(a,e)||l[o(l.length)]}t[i[0]][i[1]].type=n,t[c[0]][c[1]].type=n}(s,this.options),this.fmtMaze=function(t,e){const{row:o,col:s,start:r,end:i}=e;return{meta:{row:o,col:s,start:r,end:i},raw:t.map(t=>t.map(t=>t.type===n))}}(s,this.options)}get(){return this.fmtMaze}}});
